<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Formulario Modificar</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
    <div class="offset-4 col-4">
        <h3>Modificar una Tarea</h3>
        <label for="">Titulo de Tarea</label>
        <input class="form-control" type="text" value="" id="tituloTarea" name="tituloTarea" placeholder="Nombre de la Tarea"><br>
        
        <label for="">Prioridad</label>
        <!-- <input class="form-control" type="text" id="prioridad" name="prioridad" placeholder="Prioridad de la Tarea"><br> -->
        <select id="prioridad" name="prioridad" value="" class="form-control">
            <option value="Alta">Alta</option>
            <option value="Media">Media</option>
            <option value="Baja">Baja</option>
        </select><br>

        <label for="">Descripcion</label>
        <!-- <select name="descripcion" id="descripcion"  class="form-control">
            <option value="Alta">Alta</option>
            <option value="Media">Media</option>
            <option value="Baja">Baja</option>
        </select><br> -->
        <input class="form-control" type="text" value="" id="descripcion" name="descripcion" placeholder="Descripción de la Tarea"><br>

        <label for="">Estado</label>
        <!-- <input class="form-control" type="text" id="estado" name="estado" placeholder="Estado"><br> -->

        <select id="estado" name="estado" value="" class="form-control">
            <!-- <option value="" id="estado"></option> -->
            <option value="En tiempo">En tiempo</option>
            <option value="Finalizada">Finalizada</option>
            <option value="Vencida">Vencida</option>
        </select><br>        

        <label for="">Fecha de Inicio</label>
        <input class="form-control" type="date" value="" id="fechaInicio" name="fechaInicio" placeholder="Fecha de Inicio"><br>
        <label for="">Hora de Inicio</label>
        <input class="form-control" type="time" value="" id="horaInicio" name="horaInicio" placeholder="Hora de Inicio"><br>
        <!-- solo para mandar el id del usuario -->
        <label for="">Usuario Id</label>
        <input type="number" id="users_id" name="users_id" value="1"><br><br>


        <input type="hidden" id="id" name="id" value="">

        <label for="">Fecha de Finalización</label>
        <input class="form-control" type="date" value="" id="fechaFin" name="fechaFin" placeholder="Fecha de Finalización"><br>
        <label for="">Hora de Finalización</label>
        <input class="form-control" type="time" id="horaFin" name="horaFin" placeholder="Hora de Finalización"><br>
        <button name="submit" id="submit" class="btn btn-outline-primary">Modificar</button>
        <button name="eliminar" id="eliminar" class="btn btn-outline-danger">Eliminar</button>

    </div>
    <hr>
    <!-- <h1>Lista de Productos</h1>

        <table class="table">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">id</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Descripcion</th>
                    <th scope="col">Precio</th>
                  </tr>
                </thead>
                <tbody id="mostrar">
                </tbody>
              </table> -->
    <script>
    // $(document).ready(listar);   
    
    // function listar(){
    //     $.ajax({
    //         method:"Get",
    //         url:"http://192.168.32.136/apiRest/public/api/productos",
    //         success:function(dato){                       
    //             console.log(dato);
    //             var listar = "";   
    //             dato.productos.forEach(element => {
    //             listar = listar+'<tr>'+'<td>'+element.id+'</td>'+
    //                                     '<td>'+element.nombre+'</td>'+
    //                                     '<td>'+element.descripcion+'</td>'+
    //                                     '<td>'+element.precio+'</td>'+'</tr>';
    //         });
    //         $("#mostrar").append(listar);            
    //         },
    //         error:function(data){
    //             alert("Error al iniciar session: "+data.error);
    //         }

    //     });
    // }    

     $(document).ready(buscar);

    function buscar(){
        $.ajax({
            method:"get",
            url:"http://192.168.32.132/Gestion_Tareas/public/api/tareas/buscar",
            data:{id:4},
            success:function(dato){                       
                console.log(dato);
                   
                dato.tarea.forEach(element => {
                    $("#id").val(element.id); 
                    $("#tituloTarea").val(element.tituloTarea);
                    $("#prioridad").val(element.prioridad);  
                    $("#descripcion").val(element.descripcion);
                    $("#estado").val(element.estado);
                    $("#fechaInicio").val(element.fechaInicio);      
                    $("#fechaFin").val(element.fechaFin);  
                    $("#horaInicio").val(element.horaInicio);  
                    $("#horaFin").val(element.horaFin);  
            });
                        
            },

            
        })
    }   

    $('#submit').click(function(){
        editar();
    });

    function editar(){
        $.ajax({
            method:"post",
            url:"http://192.168.32.132/Gestion_Tareas/public/api/tareas/editar",
            data:{
                id: $('#id').val(),
                tituloTarea: $('#tituloTarea').val(),
                prioridad: $('#prioridad').val(),
                descripcion: $('#descripcion').val(),
                estado: $('#estado').val(),
                fechaInicio: $('#fechaInicio').val(),
                fechaFin: $('#fechaFin').val(),                
                horaInicio: $('#horaInicio').val(),
                horaFin: $('#horaFin').val(),
                users_id: $('#users_id').val()
            },
            success:mensaje,
            error:error
        })
    }

    $('#eliminar').click(function(){
        eliminar();
    });

    function eliminar(){
        $.ajax({
            method:"delete",
            url:"http://192.168.32.132/Gestion_Tareas/public/api/tareas/eliminar",
            data:{
                id: $('#id').val()
            },
            success:mensaje,
            error:error
        })
    }
    function mensaje(r){
        alert(r);
        location.reload();
    }
    function error(r){
        alert('error'+r);
    }
    </script>
</body>
</html>
